#!/usr/bin/env ruby

if ARGV.size == 0
  puts '
Usage: controller [ boot | quit ]
       controller [ start | status | stop | restart | log ] [worker]

Example:
  % controller boot    # start bluepilld and jobs
  % controller status  # check on status of jobs
  % controller log dor_accessionWF_descriptive-metadata # view log for worker
  % controller stop    # stop jobs
  % controller quit    # stop bluepilld
'
  exit -1
end

ENV['ROBOT_ENVIRONMENT'] ||= 'development'

if ARGV[0] == 'boot' 
  system "bluepill --no-privileged load config/environments/bluepill_#{ENV['ROBOT_ENVIRONMENT']}.rb"
else
  system "bluepill --no-privileged #{ARGV.join(' ')}"
end
